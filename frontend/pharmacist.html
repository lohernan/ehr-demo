<!doctype html>
<html>
<head><meta charset="utf-8"><title>Pharmacist - EHR Demo</title><link rel="stylesheet" href="css/style.css"></head>
  <style>
    /* Simple dropdown for account settings */
    .dropdown {
      position: relative;
      display: inline-block;
    }
    .dropdown-content {
      display: none;
      position: absolute;
      right: 0;
      background-color: #f9f9f9;
      min-width: 160px;
      box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
      z-index: 1;
    }
    .dropdown-content button {
      width: 100%;
      padding: 12px;
      border: none;
      background: none;
      text-align: left;
      cursor: pointer;
    }
    .dropdown-content button:hover {
      background-color: #f1f1f1;
    }
    .dropdown.show .dropdown-content {
      display: block;
    }
  </style>
<body>

       <div class="top-bar">
    <button class="icon-button" title="Settings" aria-label="Settings">
      <!-- Gear icon -->
      <svg viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="3"></circle>
        <path d="M19.4 15a1.7 1.7 0 0 0 .3 2.3l.3.3a2 2 0 0 1-2.8 2.8l-.3-.3a1.7 1.7 0 0 0-2.3-.3 1.7 1.7 0 0 0-1 0 1.7 1.7 0 0 0-2.3.3l-.3.3a2 2 0 1 1-2.8-2.8l.3-.3a1.7 1.7 0 0 0 0-2.3 1.7 1.7 0 0 0 0-1 1.7 1.7 0 0 0-.3-2.3l-.3-.3a2 2 0 0 1 2.8-2.8l.3.3a1.7 1.7 0 0 0 2.3 0 1.7 1.7 0 0 0 1 0 1.7 1.7 0 0 0 2.3 0l.3-.3a2 2 0 1 1 2.8 2.8l-.3.3a1.7 1.7 0 0 0 0 2.3 1.7 1.7 0 0 0 0 1z"/>
      </svg>
    </button>

    <div style="flex: 1;"></div>

    <button class="icon-button" title="Notifications" aria-label="Notifications">
      <!-- Bell icon -->
      <svg viewBox="0 0 24 24">
        <path d="M18 8a6 6 0 0 0-12 0c0 7-3 9-3 9h18s-3-2-3-9"></path>
        <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
      </svg>
    </button>

    <div class="dropdown">
      <button class="icon-button" id="profileBtn" title="Profile" aria-label="Profile">
        <!-- User icon -->
        <svg viewBox="0 0 24 24">
          <circle cx="12" cy="7" r="4"></circle>
          <path d="M5.5 21a7.5 7.5 0 0 1 13 0"></path>
        </svg>
      </button>
      <div class="dropdown-content" id="accountDropdown">
        <button id="signOutBtn">Sign Out</button>
      </div>
    </div>
  </div>
  
<div class="container">
  <h2>Pharmacist Dashboard</h2>
  <button id="load">Load pending prescriptions</button>
  <div id="pending"></div>
</div>

<script src="js/app.js"></script>
<script>
  
    // Dropdown toggle
    const profileBtn = document.getElementById('profileBtn');
    const accountDropdown = document.getElementById('accountDropdown');
    profileBtn.addEventListener('click', () => {
      accountDropdown.parentElement.classList.toggle('show');
    });
    // Close dropdown if clicking outside
    window.addEventListener('click', (e) => {
      if (!profileBtn.contains(e.target) && !accountDropdown.contains(e.target)) {
        accountDropdown.parentElement.classList.remove('show');
      }
    });

    // Sign out button
    document.getElementById('signOutBtn').addEventListener('click', () => {
      localStorage.removeItem('user');
      window.location.href = '/index.html';
    });
  async function loadPending(){
    const list = await pendingPrescriptions();
    const div = document.getElementById('pending');
    div.innerHTML = '';
    list.forEach(p => {
      const row = document.createElement('div');
      row.innerHTML = `<strong>${p.first_name} ${p.last_name}</strong> - ${p.drug_name} (${p.dosage})
        <button data-id="${p.id}">Mark Dispensed</button>`;
      div.appendChild(row);
    });
    div.querySelectorAll('button').forEach(btn=>{
      btn.addEventListener('click', async ()=> {
        const id = btn.getAttribute('data-id');
        await dispensePrescription(id);
        loadPending();
      });
    });
  }
  document.getElementById('load').addEventListener('click', loadPending);
  loadPending();
</script>
</body>
</html>
